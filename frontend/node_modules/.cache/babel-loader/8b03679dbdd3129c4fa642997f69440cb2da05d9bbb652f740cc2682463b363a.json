{"ast":null,"code":"import React,{useEffect,useState}from'react';import{Link,useNavigate}from'react-router-dom';import{CartContext}from'../context/CartContext';import{useContext}from'react';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function Navbar(_ref){let{onSearch}=_ref;const{totalItems}=useContext(CartContext);const navigate=useNavigate();const user=JSON.parse(localStorage.getItem('user'));const[showDropdown,setShowDropdown]=useState(false);const[cartCount,setCartCount]=useState(0);useEffect(()=>{const updateCartCount=()=>{const storedCart=JSON.parse(localStorage.getItem('cart'))||[];const totalItems=storedCart.reduce((sum,item)=>sum+item.quantity,0);setCartCount(totalItems);};updateCartCount();// Detectar cambios desde otros componentes\nwindow.addEventListener('storage',updateCartCount);return()=>{window.removeEventListener('storage',updateCartCount);};},[]);useEffect(()=>{const storedUser=localStorage.getItem('user');sessionStorage.setItem('user',JSON.stringify(storedUser));if(storedUser){setShowDropdown(false);}},[]);const handleLogout=()=>{localStorage.removeItem('token');localStorage.removeItem('user');navigate('/login');};return/*#__PURE__*/_jsx(\"nav\",{className:\"navbar navbar-expand-lg navbar-light bg-white shadow-sm\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(Link,{className:\"navbar-brand fw-bold\",to:\"/\",children:\"Makhana-Shop\"}),/*#__PURE__*/_jsx(\"button\",{className:\"navbar-toggler\",type:\"button\",\"data-bs-toggle\":\"collapse\",\"data-bs-target\":\"#navbarSupportedContent\",\"aria-controls\":\"navbarSupportedContent\",\"aria-expanded\":\"false\",\"aria-label\":\"Toggle navigation\",children:/*#__PURE__*/_jsx(\"span\",{className:\"navbar-toggler-icon\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"collapse navbar-collapse\",id:\"navbarSupportedContent\",children:[/*#__PURE__*/_jsx(\"form\",{className:\"d-flex mx-lg-auto my-2 my-lg-0\",style:{maxWidth:400,width:'100%'},onSubmit:e=>{e.preventDefault();},children:/*#__PURE__*/_jsx(\"input\",{className:\"form-control me-2\",type:\"search\",placeholder:\"Buscar productos...\",\"aria-label\":\"Buscar\",onChange:e=>onSearch(e.target.value)})}),/*#__PURE__*/_jsxs(\"ul\",{className:\"navbar-nav ms-auto mb-2 mb-lg-0 d-flex align-items-center gap-2\",children:[/*#__PURE__*/_jsx(\"li\",{className:\"nav-item position-relative\",children:/*#__PURE__*/_jsxs(Link,{to:\"/cart\",className:\"btn btn-outline-primary\",title:\"Carrito\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-shopping-cart\"}),totalItems>0&&/*#__PURE__*/_jsx(\"span\",{className:\"badge bg-danger position-absolute top-0 start-100 translate-middle\",style:{fontSize:'0.7rem'},children:totalItems})]})}),localStorage.getItem('token')?/*#__PURE__*/_jsxs(\"li\",{className:\"nav-item dropdown\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-outline-secondary rounded-circle d-flex align-items-center justify-content-center\",style:{width:'40px',height:'40px',padding:0},id:\"profileDropdown\",\"data-bs-toggle\":\"dropdown\",\"aria-expanded\":showDropdown,onClick:()=>setShowDropdown(!showDropdown),children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-user\"})}),/*#__PURE__*/_jsxs(\"ul\",{className:\"dropdown-menu dropdown-menu-end\".concat(showDropdown?' show':''),\"aria-labelledby\":\"profileDropdown\",style:{minWidth:'180px'},children:[/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(\"span\",{className:\"dropdown-item-text fw-bold\",children:(user===null||user===void 0?void 0:user.name)||'Usuario'})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(\"hr\",{className:\"dropdown-divider\"})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(\"button\",{className:\"dropdown-item text-danger\",onClick:handleLogout,children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-sign-out-alt me-2\"}),\"Logout\"]})})]})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"li\",{className:\"nav-item\",children:/*#__PURE__*/_jsx(Link,{to:\"/login\",className:\"btn btn-primary\",title:\"Login\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-sign-in-alt\"})})}),/*#__PURE__*/_jsx(\"li\",{className:\"nav-item\",children:/*#__PURE__*/_jsx(Link,{to:\"/register\",className:\"btn btn-outline-primary\",title:\"Registro\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-user-plus\"})})})]})]})]})]})});}export default Navbar;","map":{"version":3,"names":["React","useEffect","useState","Link","useNavigate","CartContext","useContext","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Navbar","_ref","onSearch","totalItems","navigate","user","JSON","parse","localStorage","getItem","showDropdown","setShowDropdown","cartCount","setCartCount","updateCartCount","storedCart","reduce","sum","item","quantity","window","addEventListener","removeEventListener","storedUser","sessionStorage","setItem","stringify","handleLogout","removeItem","className","children","to","type","id","style","maxWidth","width","onSubmit","e","preventDefault","placeholder","onChange","target","value","title","fontSize","height","padding","onClick","concat","minWidth","name"],"sources":["C:/Users/ashu/Documents/ashu-shop/frontend/src/components/Navbar.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { Link, useNavigate } from 'react-router-dom';\r\nimport { CartContext } from '../context/CartContext';\r\nimport { useContext } from 'react';\r\n\r\nfunction Navbar({ onSearch }) {\r\n\r\n  const { totalItems } = useContext(CartContext);\r\n  const navigate = useNavigate();\r\n  const user = JSON.parse(localStorage.getItem('user'));\r\n  const [showDropdown, setShowDropdown] = useState(false);\r\n  const [cartCount, setCartCount] = useState(0);\r\n\r\n  useEffect(() => {\r\n    const updateCartCount = () => {\r\n      const storedCart = JSON.parse(localStorage.getItem('cart')) || [];\r\n      const totalItems = storedCart.reduce((sum, item) => sum + item.quantity, 0);\r\n      setCartCount(totalItems);\r\n    };\r\n\r\n    updateCartCount();\r\n\r\n    // Detectar cambios desde otros componentes\r\n    window.addEventListener('storage', updateCartCount);\r\n\r\n    return () => {\r\n      window.removeEventListener('storage', updateCartCount);\r\n    };\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const storedUser = localStorage.getItem('user');  \r\n\r\n  sessionStorage.setItem('user', JSON.stringify(storedUser));\r\n    if (storedUser) {\r\n      setShowDropdown(false);     \r\n  }\r\n  }, []);\r\n\r\n  const handleLogout = () => {\r\n    localStorage.removeItem('token');\r\n    localStorage.removeItem('user');\r\n    \r\n    navigate('/login');\r\n  };\r\n\r\n  return (\r\n    <nav className=\"navbar navbar-expand-lg navbar-light bg-white shadow-sm\">\r\n      <div className=\"container\">\r\n        <Link className=\"navbar-brand fw-bold\" to=\"/\">Makhana-Shop</Link>\r\n        <button\r\n          className=\"navbar-toggler\"\r\n          type=\"button\"\r\n          data-bs-toggle=\"collapse\"\r\n          data-bs-target=\"#navbarSupportedContent\"\r\n          aria-controls=\"navbarSupportedContent\"\r\n          aria-expanded=\"false\"\r\n          aria-label=\"Toggle navigation\"\r\n        >\r\n          <span className=\"navbar-toggler-icon\"></span>\r\n        </button>\r\n\r\n        <div className=\"collapse navbar-collapse\" id=\"navbarSupportedContent\">\r\n          <form\r\n            className=\"d-flex mx-lg-auto my-2 my-lg-0\"\r\n            style={{ maxWidth: 400, width: '100%' }}\r\n            onSubmit={e => { e.preventDefault(); }}\r\n          >\r\n            <input\r\n              className=\"form-control me-2\"\r\n              type=\"search\"\r\n              placeholder=\"Buscar productos...\"\r\n              aria-label=\"Buscar\"\r\n              onChange={e => onSearch(e.target.value)}\r\n            />\r\n          </form>\r\n\r\n          <ul className=\"navbar-nav ms-auto mb-2 mb-lg-0 d-flex align-items-center gap-2\">\r\n            <li className=\"nav-item position-relative\">\r\n              <Link to=\"/cart\" className=\"btn btn-outline-primary\" title=\"Carrito\">\r\n                <i className=\"fas fa-shopping-cart\"></i>\r\n                {totalItems > 0 && (\r\n                  <span\r\n                    className=\"badge bg-danger position-absolute top-0 start-100 translate-middle\"\r\n                    style={{ fontSize: '0.7rem' }}\r\n                  >\r\n                    {totalItems}\r\n                  </span>\r\n                )}\r\n              </Link>\r\n            </li>\r\n\r\n            {localStorage.getItem('token') ? (\r\n              <li className=\"nav-item dropdown\">\r\n                <button\r\n                  className=\"btn btn-outline-secondary rounded-circle d-flex align-items-center justify-content-center\"\r\n                  style={{ width: '40px', height: '40px', padding: 0 }}\r\n                  id=\"profileDropdown\"\r\n                  data-bs-toggle=\"dropdown\"\r\n                  aria-expanded={showDropdown}\r\n                  onClick={() => setShowDropdown(!showDropdown)}\r\n                >\r\n                  <i className=\"fas fa-user\"></i>\r\n                </button>\r\n                <ul\r\n                  className={`dropdown-menu dropdown-menu-end${showDropdown ? ' show' : ''}`}\r\n                  aria-labelledby=\"profileDropdown\"\r\n                  style={{ minWidth: '180px' }}\r\n                >\r\n                  <li>\r\n                    <span className=\"dropdown-item-text fw-bold\">\r\n                      {user?.name || 'Usuario'}\r\n                    </span>\r\n                  </li>\r\n                  <li><hr className=\"dropdown-divider\" /></li>\r\n                  <li>\r\n                    <button className=\"dropdown-item text-danger\" onClick={handleLogout}>\r\n                      <i className=\"fas fa-sign-out-alt me-2\"></i>Logout\r\n                    </button>\r\n                  </li>\r\n                </ul>\r\n              </li>\r\n            ) : (\r\n              <>\r\n                <li className=\"nav-item\">\r\n                  <Link to=\"/login\" className=\"btn btn-primary\" title=\"Login\">\r\n                    <i className=\"fas fa-sign-in-alt\"></i>\r\n                  </Link>\r\n                </li>\r\n                <li className=\"nav-item\">\r\n                  <Link to=\"/register\" className=\"btn btn-outline-primary\" title=\"Registro\">\r\n                    <i className=\"fas fa-user-plus\"></i>\r\n                  </Link>\r\n                </li>\r\n              </>\r\n            )}\r\n          </ul>\r\n        </div>\r\n      </div>\r\n    </nav>\r\n  );\r\n}\r\n\r\nexport default Navbar;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}